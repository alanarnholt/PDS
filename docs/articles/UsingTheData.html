<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Passion Driven Statistics. PDS</title><!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <div class="container">
      <header><div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">PDS</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alanarnholt/PDS">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Passion Driven Statistics</h1>
                        <h4 class="author">Alan T. Arnholt</h4>
            
            <h4 class="date">2016-10-13</h4>
          </div>

    
    
<div id="using-pds" class="section level2">
<h2>Using <strong>PDS</strong></h2>
<p>Once the <code>PDS</code> package is installed, you will need to load the package using the <code>library</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">library</span>(PDS)</code></pre></div>
<p>If you need directions for installing the <code>PDS</code> package, see <a href="https://github.com/alanarnholt/PDS" class="uri">https://github.com/alanarnholt/PDS</a>. Code Books for <code>AddHealth</code>, <code>gapminder</code>, <code>marscrater</code>, and <code>NESARC</code> are in the <code>CodeBooks</code> folder of the installed <code>PDS</code> package. To see where your system has installed the <code>PDS</code> package, type the following at the <code>R</code> prompt:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">system.file</span>(<span class="dt">package =</span> <span class="st">"PDS"</span>)</code></pre></div>
<p>The Code Books are stored as PDFs. Note: To find a word/variable in a <code>PDF</code> use <code>shift F</code> with Windows or <code>command F</code> with OSX. Type the desired word/variable inside the box and press enter/return.</p>
<p>Once the <code>PDS</code> package is attached with the <code>library()</code> function, one may access the data in one of the data frames by typing the name of the data frame at the <code>R</code> prompt. For example, to see the first five values in the variable <code>incomeperperson</code> from the <code>gapminder</code> data frame enter</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>gapminder[<span class="dv">1</span>:<span class="dv">5</span>, <span class="st">'incomeperperson'</span>]  <span class="co"># Show first five rows for incomeperperson</span></code></pre></div>
<pre><code>[1]        NA  1914.997  2231.993 21943.340  1381.004</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>gapminder[<span class="dv">1</span>:<span class="dv">5</span>, <span class="dv">1</span>:<span class="dv">4</span>]  <span class="co"># Show the first five rows for variables 1 through 4</span></code></pre></div>
<pre><code>      country incomeperperson alcconsumption armedforcesrate
1 Afghanistan              NA           0.03       0.5696534
2     Albania        1914.997           7.29       1.0247361
3     Algeria        2231.993           0.69       2.3068170
4     Andorra       21943.340          10.17              NA
5      Angola        1381.004           5.57       1.4613288</code></pre>
<div id="data-management-using-the-dplyr-package" class="section level3">
<h3>Data Management Using the <code>dplyr</code> Package</h3>
<p>The package <code>dplyr</code> must first be installed before it can be used. There are two ways one can install the package. The easiest way to install <code>dplyr</code> is to type</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">install.packages</span>(<span class="st">"dplyr"</span>)</code></pre></div>
<p>at the <code>R</code> prompt. If you want the latest version of <code>dplyr</code>, you can install the development version from GitHub provided you have the required tools to build <code>R</code> packages installed on your machine (<code>Rtools</code> for Windows users, <code>XCode</code> for Mac users, etc.).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>if (<span class="kw">packageVersion</span>(<span class="st">"devtools"</span>) &lt;<span class="st"> </span><span class="fl">1.6</span>) {
+<span class="st">   </span><span class="kw">install.packages</span>(<span class="st">"devtools"</span>)
+<span class="st"> </span>}
&gt;<span class="st"> </span>devtools::<span class="kw">install_github</span>(<span class="st">"hadley/lazyeval"</span>)
&gt;<span class="st"> </span>devtools::<span class="kw">install_github</span>(<span class="st">"hadley/dplyr"</span>)</code></pre></div>
</div>
<div id="subsetting-your-data" class="section level3">
<h3>Subsetting Your Data</h3>
<p>Create a subset of people 25 years old or younger who smoked in the last 12 months. To do this, one can use the <code>dplyr</code> package. Note that <code>CHECK321 == 1</code> is used to see if a subject has smoked in the past 12 months and <code>!is.na()</code> is used to make sure the subset does not contain <code>NA</code>s for the chosen variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">library</span>(dplyr)
&gt;<span class="st"> </span>nesarc &lt;-<span class="st"> </span><span class="kw">tbl_df</span>(NESARC) %&gt;%<span class="st"> </span>
+<span class="st">   </span><span class="kw">filter</span>(!<span class="kw">is.na</span>(CHECK321) &amp;<span class="st"> </span>!<span class="kw">is.na</span>(AGE) &amp;<span class="st"> </span>CHECK321 ==<span class="dv">1</span> &amp;<span class="st"> </span>AGE &lt;=<span class="st"> </span><span class="dv">25</span>)
&gt;<span class="st"> </span><span class="kw">dim</span>(nesarc)</code></pre></div>
<pre><code>[1] 1706 3008</code></pre>
<p>The <code>nesarc</code> data frame contains 3008 variables.</p>
<p>Three different approaches to subsetting data will be given. The first approach is to use the <code>dplyr</code> function <code>filter</code>; the second approach is to use indices; and the third approach is to use the function <code>subset</code>. Consider creating a subset of the <code>NESARC</code> data set where a person indicates</p>
<ol style="list-style-type: decimal"><li>He/she has smoked over 100 cigarettes (<code>S3AQ1A == 1</code>)</li>
<li>He/she has smoked in the past year (<code>CHECK321 == 1</code>)</li>
<li>He/she has typically smoked every day over the last year (<code>S3AQ3B1 == 1</code>)</li>
<li>He/she is less than or equal to 25 years old (<code>AGE &lt;= 25</code>)</li>
</ol><p>The first approach uses the <code>filter</code> function with the <code>%&gt;%</code> function. Although it is not a requirement, the data frame <code>NESARC</code> is converted to a <code>data frame tbl</code> per the advice given in the <code>dplyr</code> vignette.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARCsub1 &lt;-<span class="st"> </span><span class="kw">tbl_df</span>(NESARC) %&gt;%
+<span class="st">   </span><span class="kw">filter</span>(S3AQ1A ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>CHECK321 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>S3AQ3B1 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>AGE &lt;=<span class="st"> </span><span class="dv">25</span>)
&gt;<span class="st"> </span><span class="kw">dim</span>(NESARCsub1)</code></pre></div>
<pre><code>[1] 1320 3008</code></pre>
<p>The second approach uses standard indexing.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARCsub2 &lt;-<span class="st"> </span>NESARC[NESARC$S3AQ1A ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>NESARC$CHECK321 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>
+<span class="st">                        </span>NESARC$S3AQ3B1 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>NESARC$AGE &lt;=<span class="st"> </span><span class="dv">25</span>, ]
&gt;<span class="st"> </span><span class="kw">dim</span>(NESARCsub2)</code></pre></div>
<pre><code>[1] 1320 3008</code></pre>
<p>The third approach uses the <code>subset</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARCsub3 &lt;-<span class="st"> </span><span class="kw">subset</span>(NESARC, <span class="dt">subset =</span> S3AQ1A ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>CHECK321 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>
+<span class="st">                        </span>S3AQ3B1 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>AGE &lt;=<span class="st"> </span><span class="dv">25</span>)
&gt;<span class="st"> </span><span class="kw">dim</span>(NESARCsub3)</code></pre></div>
<pre><code>[1] 1320 3008</code></pre>
<p>Use the verb <code>select</code> from the <code>dplyr</code> package to select the variables <code>CHECK321</code>, <code>AGE</code> (age of subject), <code>TAB12MDX</code> (tobacco dependence past 12 months), <code>S3AQ3B1</code> (usual smoking quantity), <code>ETHRACE2A</code> (ethnicity), <code>SEX</code> (gender), <code>MAJORDEPLIFE</code> (Dysthymia-Lifetime), and <code>S3AQ3C1</code> (usual smoking frequency).</p>
</div>
<div id="renaming-variables" class="section level3">
<h3>Renaming Variables</h3>
<p>Renaming the variables <code>IDNUM</code>, <code>ETOTLCA2</code>, <code>ETHRACE2A</code>, <code>S3AQ3B1</code>, <code>AGE</code>, <code>MAJORDEPLIFE</code>, <code>DYSLIFE</code>, <code>TAB12MDX</code>, and <code>S3AQ3C1</code> to <code>UniqueID</code>, <code>EthanolConsumption</code>, <code>Ethnicity</code>, <code>SmokingFrequency</code>, <code>Age</code>, <code>MajorDepression</code>, <code>DysthymiaLifetime</code>, <code>TobaccoDependence</code>, and <code>DailyCigsSmoked</code> respectively, is done with the <code>rename</code> function. Although it is not a requirement, the data frame <code>NESARC</code> is converted to a <code>data frame tbl</code> per the advice given in the <code>dplyr</code> vignette. The <code>rename</code> function takes a data frame or data frame tbl as its first argument while the syntax <code>new_name = old_name</code> is used as the second argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARC[<span class="dv">1</span>:<span class="dv">5</span>, <span class="dv">1</span>:<span class="dv">5</span>]  <span class="co"># Show first 5 rows and first 5 columns of NESARC</span></code></pre></div>
<pre><code>  IDNUM ETOTLCA2 ETHRACE2A   PSU STRATUM
1     1       NA         5  4007     403
2     2   0.0014         5  6045     604
3     3       NA         5 12042    1218
4     4       NA         5 17099    1704
5     5       NA         2 17099    1704</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARCtbl &lt;-<span class="st"> </span><span class="kw">tbl_df</span>(NESARC) %&gt;%<span class="st"> </span>
+<span class="st">   </span><span class="kw">rename</span>(<span class="dt">UniqueID =</span> IDNUM, <span class="dt">EthanolConsumption =</span> ETOTLCA2, <span class="dt">Ethnicity =</span> ETHRACE2A, 
+<span class="st">          </span><span class="dt">SmokingFrequency =</span> S3AQ3B1, <span class="dt">Age =</span> AGE, <span class="dt">MajorDepression =</span> MAJORDEPLIFE, <span class="dt">Sex =</span> SEX, 
+<span class="st">          </span><span class="dt">DysthymiaLifetime =</span> DYSLIFE, <span class="dt">TobaccoDependence =</span> TAB12MDX, <span class="dt">DailyCigsSmoked =</span> S3AQ3C1) %&gt;%<span class="st"> </span>
+<span class="st">   </span><span class="kw">select</span>(UniqueID, EthanolConsumption, Ethnicity, SmokingFrequency, Age, MajorDepression, 
+<span class="st">          </span>DysthymiaLifetime, TobaccoDependence, DailyCigsSmoked, S3AQ1A, CHECK321, 
+<span class="st">          </span>SmokingFrequency, Sex)  
&gt;<span class="st"> </span>NESARCtbl</code></pre></div>
<pre><code># A tibble: 43,093 &times; 12
   UniqueID EthanolConsumption Ethnicity SmokingFrequency   Age
     &lt;fctr&gt;              &lt;dbl&gt;    &lt;fctr&gt;           &lt;fctr&gt; &lt;dbl&gt;
1         1                 NA         5               NA    23
2         2             0.0014         5               NA    28
3         3                 NA         5               NA    81
4         4                 NA         5               NA    18
5         5                 NA         2               NA    36
6         6             0.0021         2               NA    34
7         7             0.0033         2               NA    19
8         8             0.0271         1               NA    84
9         9             0.0295         1               NA    29
10       10             0.1565         5               NA    18
# ... with 43,083 more rows, and 7 more variables: MajorDepression &lt;fctr&gt;,
#   DysthymiaLifetime &lt;fctr&gt;, TobaccoDependence &lt;fctr&gt;,
#   DailyCigsSmoked &lt;dbl&gt;, S3AQ1A &lt;fctr&gt;, CHECK321 &lt;fctr&gt;, Sex &lt;fctr&gt;</code></pre>
</div>
<div id="coding-missing-values" class="section level3">
<h3>Coding Missing Values</h3>
<p>Note that the variable <code>S3AQ3B1</code> renamed to <code>SmokingFrequency</code> uses a 9 to record <code>unknown</code> for smoking frequency.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARCtbl$SmokingFrequency[NESARCtbl$SmokingFrequency ==<span class="st"> </span><span class="dv">9</span>] &lt;-<span class="st"> </span><span class="ot">NA</span>
&gt;<span class="st"> </span><span class="kw">summary</span>(NESARCtbl$SmokingFrequency)  <span class="co"># Note that 9 still appears</span></code></pre></div>
<pre><code>    1     2     3     4     5     6     9  NA's 
14836   460   687   747   409   772     0 25182 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARCtbl$SmokingFrequency &lt;-<span class="st"> </span><span class="kw">factor</span>(NESARCtbl$SmokingFrequency)[, drop =<span class="st"> </span><span class="ot">TRUE</span>]
&gt;<span class="st"> </span><span class="kw">summary</span>(NESARCtbl$SmokingFrequency)  <span class="co"># Unused level no longer appears</span></code></pre></div>
<pre><code>    1     2     3     4     5     6  NA's 
14836   460   687   747   409   772 25182 </code></pre>
<p>One of the great things about the <code>R</code> language is how it handles a wide variety of data types.<br>
In this case, the variable <code>SmokingFrequency</code> is a factor with numeric labels for the levels of the factor.<br>
To change the numeric labels to text type the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARCtbl$SmokingFrequency &lt;-<span class="st"> </span><span class="kw">factor</span>(NESARCtbl$SmokingFrequency, 
+<span class="st">                                      </span><span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"Every Day"</span>, <span class="st">"5 to 6 Days/week"</span>, 
+<span class="st">                                                 "3 to 4 Days/week"</span>, <span class="st">"1 to 2 Days/week"</span>, 
+<span class="st">                                                 "2 to 3 Days/month"</span>, <span class="st">"Once a month or less"</span>))
&gt;<span class="st"> </span><span class="kw">summary</span>(NESARCtbl$SmokingFrequency)</code></pre></div>
<pre><code>           Every Day     5 to 6 Days/week     3 to 4 Days/week 
               14836                  460                  687 
    1 to 2 Days/week    2 to 3 Days/month Once a month or less 
                 747                  409                  772 
                NA's 
               25182 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">xtabs</span>(~SmokingFrequency, <span class="dt">data =</span> NESARCtbl) <span class="co"># Note how the NA's are not printed</span></code></pre></div>
<pre><code>SmokingFrequency
           Every Day     5 to 6 Days/week     3 to 4 Days/week 
               14836                  460                  687 
    1 to 2 Days/week    2 to 3 Days/month Once a month or less 
                 747                  409                  772 </code></pre>
<p>The following <code>ggplot2</code> code is used to graph the values in <code>SmokingFrequency</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">library</span>(ggplot2)
&gt;<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> NESARCtbl, <span class="kw">aes</span>(<span class="dt">x =</span> SmokingFrequency)) +<span class="st"> </span>
+<span class="st">   </span><span class="kw">geom_bar</span>(<span class="dt">fill =</span> <span class="st">"lightgray"</span>) +<span class="st"> </span>
+<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Smoking Frequency"</span>) +
+<span class="st">   </span><span class="kw">theme_bw</span>() </code></pre></div>
<p><img src="UsingTheData_files/figure-html/ggSmoke-1.png" width="672"></p>
<p>If you do not want to see the <code>NA</code>&rsquo;s or have the labels on the <span class="math inline">\(x\)</span>- axis overlap, use</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">na.omit</span>(NESARCtbl[ , <span class="st">"SmokingFrequency"</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>]), <span class="kw">aes</span>(<span class="dt">x =</span> SmokingFrequency)) +<span class="st"> </span>
+<span class="st">   </span><span class="kw">geom_bar</span>(<span class="dt">fill =</span> <span class="st">"lightgray"</span>) +<span class="st"> </span>
+<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Smoking Frequency"</span>) +
+<span class="st">   </span><span class="kw">theme_bw</span>() +
+<span class="st">   </span><span class="kw">theme</span>(<span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">55</span>, <span class="dt">hjust =</span> <span class="fl">1.0</span>)) </code></pre></div>
<p><img src="UsingTheData_files/figure-html/ggSmoke2-1.png" width="576"></p>
</div>
<div id="collapsing-categories" class="section level3">
<h3>Collapsing Categories</h3>
<p>Consider the variable <code>S1Q6A</code> which has 14 levels that record the highest level of education of the participant. To collapse the categories into a dichotomous variable that indicates the presence of a high school degree, use the <code>ifelse</code> function. The levels <code>1</code>, <code>2</code>, <code>3</code>, <code>4</code>, <code>5</code>, <code>6</code>, and <code>7</code> of the variable <code>S1Q6A</code> correspond to education levels less than completing high school.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARC$HS_DEGREE &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">ifelse</span>(NESARC$S1Q6A %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span>, <span class="st">"7"</span>), 
+<span class="st">                                   "No"</span>, <span class="st">"Yes"</span>))
&gt;<span class="st"> </span><span class="kw">summary</span>(NESARC$HS_DEGREE)</code></pre></div>
<pre><code>   No   Yes 
 7849 35244 </code></pre>
</div>
<div id="creating-a-factor-from-a-numeric-vector" class="section level3">
<h3>Creating a Factor from a Numeric Vector</h3>
<p>To create a factor with three levels (young adults, adults, older adults) using the variable <code>AGE</code> (a numeric vector) use the function <code>cut</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARC$AGEfac &lt;-<span class="st"> </span><span class="kw">cut</span>(NESARC$AGE, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">18</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="ot">Inf</span>), 
+<span class="st">                      </span><span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"Young Adult"</span>, <span class="st">"Adult"</span>, <span class="st">"Older Adult"</span>), 
+<span class="st">                      </span><span class="dt">include.lowest =</span> <span class="ot">TRUE</span>)
&gt;<span class="st"> </span><span class="kw">summary</span>(NESARC$AGEfac)</code></pre></div>
<pre><code>Young Adult       Adult Older Adult 
       9535       17260       16298 </code></pre>
<p>Consider collapsing the numeric vector <code>S3AQ3C1</code> (usual quantity when cigarettes are smoked) into a categorical variable with 5 levels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARC$S3AQ3C1fac &lt;-<span class="st"> </span><span class="kw">cut</span>(NESARC$S3AQ3C1, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">100</span>), 
+<span class="st">                          </span><span class="dt">include.lowest =</span> <span class="ot">TRUE</span>)
&gt;<span class="st"> </span><span class="kw">summary</span>(NESARC$S3AQ3C1fac)</code></pre></div>
<pre><code>   [0,5]   (5,10]  (10,15]  (15,20] (20,100]     NA's 
    4384     4157     1163     5492     2817    25080 </code></pre>
</div>
<div id="aggregating-variables-using-ifelse" class="section level3">
<h3>Aggregating Variables using <code>ifelse</code></h3>
<p>Consider creating a new variable <code>DepressLife</code> which is <code>Yes</code> if the variable <code>MAJORLIFE</code> or <code>DYSLIFE</code> is a 1.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARC$DepressLife &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">ifelse</span>( (NESARC$MAJORDEPLIFE ==<span class="st"> </span><span class="dv">1</span> |<span class="st"> </span>NESARC$DYSLIFE ==<span class="st"> </span><span class="dv">1</span>), <span class="st">"Yes"</span>, <span class="st">"No"</span>))
&gt;<span class="st"> </span><span class="kw">summary</span>(NESARC$DepressLife)</code></pre></div>
<pre><code>   No   Yes 
34894  8199 </code></pre>
<p>As another example, consider creating a variable <code>PPpanic</code> for past and present panic disorders. The variables <code>APANDX12</code> and <code>APANDXP12</code> record a panic disorder within the last 12 months and prior to the last 12 months, respectively, with agoraphobia. The variables <code>PANDX12</code> and <code>PANDXP12</code> record a panic disorder within the last 12 months and prior to the last 12 months, respectively, without agoraphobia.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARC$PPpanic &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">ifelse</span>( (NESARC$APANDX12 ==<span class="st"> </span><span class="dv">1</span> |<span class="st"> </span>NESARC$APANDXP12 ==<span class="st"> </span><span class="dv">1</span> |<span class="st"> </span>
+<span class="st">                                     </span>NESARC$PANDX12 ==<span class="st"> </span><span class="dv">1</span> |<span class="st"> </span>NESARC$PANDXP12 ==<span class="st"> </span><span class="dv">1</span> ), <span class="st">"Yes"</span>, <span class="st">"No"</span>))
&gt;<span class="st"> </span><span class="kw">summary</span>(NESARC$PPpanic)</code></pre></div>
<pre><code>   No   Yes 
40799  2294 </code></pre>
<p>Consider a new variable <code>AllDeprSymp</code> that records whether a subject exhibits all depression symptoms or not. There are 19 depression symptoms recorded in the variables <code>S4AQ4A1</code> - <code>S4AQ4A19</code>. Note that the logical operator <code>&amp;</code> is used to test if all depression symptoms are present.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARC$AllDeprSymp &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">ifelse</span>( (NESARC$S4AQ4A1 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>NESARC$S4AQ4A2 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>
+<span class="st">                                         </span>NESARC$S4AQ4A3 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>NESARC$S4AQ4A4 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>
+<span class="st">                                         </span>NESARC$S4AQ4A5 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>NESARC$S4AQ4A6 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>
+<span class="st">                                         </span>NESARC$S4AQ4A7 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>NESARC$S4AQ4A8 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>
+<span class="st">                                         </span>NESARC$S4AQ4A9 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>NESARC$S4AQ4A10 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>
+<span class="st">                                         </span>NESARC$S4AQ4A11 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>NESARC$S4AQ4A12 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>
+<span class="st">                                         </span>NESARC$S4AQ4A13 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>NESARC$S4AQ4A14 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>
+<span class="st">                                         </span>NESARC$S4AQ4A15 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>NESARC$S4AQ4A16 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>
+<span class="st">                                         </span>NESARC$S4AQ4A17 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>NESARC$S4AQ4A18 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>
+<span class="st">                                         </span>NESARC$S4AQ4A19 ==<span class="st"> </span><span class="dv">1</span>), <span class="st">"Yes"</span>, <span class="st">"No"</span>))
&gt;<span class="st"> </span><span class="kw">summary</span>(NESARC$AllDeprSymp)</code></pre></div>
<pre><code>   No   Yes  NA's 
13738    15 29340 </code></pre>
</div>
<div id="creating-a-composite-factor" class="section level3">
<h3>Creating a Composite Factor</h3>
<p>The following code selects the 19 variables that deal with depression using the <code>select</code> function from <code>dplyr</code>. The variable <code>nDS</code> counts the number of depression symptoms a subject displays.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>mysum &lt;-<span class="st"> </span>function(x){<span class="kw">sum</span>(x ==<span class="st"> </span><span class="dv">1</span>)}
&gt;<span class="st"> </span>myadd &lt;-<span class="st"> </span>function(x){<span class="kw">apply</span>(x, <span class="dv">1</span>, mysum)}
&gt;<span class="st"> </span>ndf &lt;-<span class="st"> </span>NESARC %&gt;%
+<span class="st">   </span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">"S4AQ4A"</span>))
&gt;<span class="st"> </span>nDS &lt;-<span class="st"> </span><span class="kw">myadd</span>(ndf)
&gt;<span class="st"> </span>ndf &lt;-<span class="st"> </span><span class="kw">cbind</span>(ndf, nDS)
&gt;<span class="st"> </span><span class="kw">xtabs</span>(~nDS, <span class="dt">data =</span> ndf)    </code></pre></div>
<pre><code>nDS
   0    1    2    3    4    5    6    7    8    9   10   11   12   13   14 
1125  716  840  874  997 1032 1056 1043  970  981  940  824  737  586  413 
  15   16   17   18   19 
 295  181   97   31   15 </code></pre>
</div>
<div id="creating-a-new-variable-with-mutate" class="section level3">
<h3>Creating a New Variable with <code>mutate</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>MINI &lt;-<span class="st"> </span><span class="kw">tbl_df</span>(NESARC) %&gt;%<span class="st"> </span>
+<span class="st">   </span><span class="kw">select</span>(S1Q24FT, S1Q24IN, S1Q24LB, SEX) %&gt;%<span class="st"> </span>
+<span class="st">   </span><span class="kw">filter</span>(S1Q24FT &lt;<span class="st"> </span><span class="dv">99</span>, S1Q24IN &lt;<span class="st"> </span><span class="dv">99</span>, S1Q24LB &lt;<span class="st"> </span><span class="dv">999</span>) %&gt;%<span class="st"> </span>
+<span class="st">   </span><span class="kw">mutate</span>(<span class="dt">Inches =</span> (S1Q24FT*<span class="dv">12</span> +<span class="st"> </span>S1Q24IN),
+<span class="st">          </span><span class="dt">Sex =</span> <span class="kw">factor</span>(SEX, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>))) %&gt;%<span class="st"> </span>
+<span class="st">   </span><span class="kw">rename</span>(<span class="dt">Weight =</span> S1Q24LB)
&gt;<span class="st"> </span>MINI</code></pre></div>
<pre><code># A tibble: 41,654 &times; 6
   S1Q24FT S1Q24IN Weight    SEX Inches    Sex
     &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;fctr&gt;  &lt;dbl&gt; &lt;fctr&gt;
1        5       7    195      1     67   Male
2        5       1    127      2     61 Female
3        5       4    185      2     64 Female
4        5       7    180      1     67   Male
5        6       1    220      1     73   Male
6        5       5    140      2     65 Female
7        5       9    160      1     69   Male
8        5       4    120      2     64 Female
9        5       4    140      2     64 Female
10       5      10    150      2     70 Female
# ... with 41,644 more rows</code></pre>
<div id="convert-a-factor-to-numeric" class="section level4">
<h4>Convert a factor to numeric</h4>
<p>Be careful when converting a factor to a vector of numeric values based on the factor labels. One may be tempted to use <code>as.numeric</code> to convert a factor to a numeric vector. However, using <code>as.numeric(my_factor)</code> returns a numeric vector of the index levels, not the actual values.</p>
<p>To estimate the total number of cigarettes a subject smokes per month, convert <code>S3AQ3B1</code> renamed to <code>SmokingFrequency</code> in <code>NESARCtbl</code> (a factor with 6 levels) to a numeric variable using <code>as.numeric</code>. <code>DaysSmoke</code> estimates the days per month a subject smokes. The variable <code>TotalCigsSmoked</code> estimates the number of cigarettes a subject smokes per month by multiplying <code>DaysSmoke</code> times <code>DailyCigsSmoked</code> (<code>S3AQ3C1</code>). The numeric variable <code>TotalCigsSmoked</code> is converted into a factor with roughly equivalent numbers stored in each level of the factor <code>CigsSmokedFac</code> using the <code>cut</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">summary</span>(NESARCtbl$SmokingFrequency)</code></pre></div>
<pre><code>           Every Day     5 to 6 Days/week     3 to 4 Days/week 
               14836                  460                  687 
    1 to 2 Days/week    2 to 3 Days/month Once a month or less 
                 747                  409                  772 
                NA's 
               25182 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">levels</span>(NESARCtbl$SmokingFrequency)</code></pre></div>
<pre><code>[1] "Every Day"            "5 to 6 Days/week"     "3 to 4 Days/week"    
[4] "1 to 2 Days/week"     "2 to 3 Days/month"    "Once a month or less"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">table</span>(<span class="kw">as.numeric</span>(NESARCtbl$SmokingFrequency))</code></pre></div>
<pre><code>
    1     2     3     4     5     6 
14836   460   687   747   409   772 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARCtbl$DaysSmoke &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(NESARCtbl$SmokingFrequency)
&gt;<span class="st"> </span>NESARCtbl$DaysSmoke[NESARCtbl$DaysSmoke ==<span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">30</span>
&gt;<span class="st"> </span>NESARCtbl$DaysSmoke[NESARCtbl$DaysSmoke ==<span class="st"> </span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">4</span>*<span class="fl">5.5</span>
&gt;<span class="st"> </span>NESARCtbl$DaysSmoke[NESARCtbl$DaysSmoke ==<span class="st"> </span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">4</span>*<span class="fl">3.5</span>
&gt;<span class="st"> </span>NESARCtbl$DaysSmoke[NESARCtbl$DaysSmoke ==<span class="st"> </span><span class="dv">4</span>] &lt;-<span class="st"> </span><span class="dv">4</span>*<span class="fl">1.5</span>
&gt;<span class="st"> </span>NESARCtbl$DaysSmoke[NESARCtbl$DaysSmoke ==<span class="st"> </span><span class="dv">5</span>] &lt;-<span class="st"> </span><span class="fl">2.5</span>
&gt;<span class="st"> </span>NESARCtbl$DaysSmoke[NESARCtbl$DaysSmoke ==<span class="st"> </span><span class="dv">6</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
&gt;<span class="st"> </span><span class="co"># Using dplyr again</span>
<span class="er">&gt;</span><span class="st"> </span>NESARCtbl &lt;-<span class="st"> </span>NESARCtbl %&gt;%<span class="st"> </span>
+<span class="st">   </span><span class="kw">mutate</span>(<span class="dt">TotalCigsSmoked =</span> DaysSmoke*DailyCigsSmoked)
&gt;<span class="st"> </span>proportions &lt;-<span class="st"> </span><span class="kw">quantile</span>(NESARCtbl$TotalCigsSmoked, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
&gt;<span class="st"> </span>proportions</code></pre></div>
<pre><code>  0%  25%  50%  75% 100% 
   1  150  420  600 2970 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARCtbl$CigsSmokedFac &lt;-<span class="st"> </span><span class="kw">cut</span>(NESARCtbl$TotalCigsSmoked, <span class="dt">breaks =</span> proportions, 
+<span class="st">                                </span><span class="dt">include.lowest =</span> <span class="ot">TRUE</span>)
&gt;<span class="st"> </span>NESARCtbl</code></pre></div>
<pre><code># A tibble: 43,093 &times; 15
   UniqueID EthanolConsumption Ethnicity SmokingFrequency   Age
     &lt;fctr&gt;              &lt;dbl&gt;    &lt;fctr&gt;           &lt;fctr&gt; &lt;dbl&gt;
1         1                 NA         5               NA    23
2         2             0.0014         5               NA    28
3         3                 NA         5               NA    81
4         4                 NA         5               NA    18
5         5                 NA         2               NA    36
6         6             0.0021         2               NA    34
7         7             0.0033         2               NA    19
8         8             0.0271         1               NA    84
9         9             0.0295         1               NA    29
10       10             0.1565         5               NA    18
# ... with 43,083 more rows, and 10 more variables:
#   MajorDepression &lt;fctr&gt;, DysthymiaLifetime &lt;fctr&gt;,
#   TobaccoDependence &lt;fctr&gt;, DailyCigsSmoked &lt;dbl&gt;, S3AQ1A &lt;fctr&gt;,
#   CHECK321 &lt;fctr&gt;, Sex &lt;fctr&gt;, DaysSmoke &lt;dbl&gt;, TotalCigsSmoked &lt;dbl&gt;,
#   CigsSmokedFac &lt;fctr&gt;</code></pre>
</div>
<div id="subsetting-again" class="section level4">
<h4>Subsetting Again</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARCtbl &lt;-<span class="st"> </span>NESARCtbl %&gt;%<span class="st"> </span>
+<span class="st">   </span><span class="kw">filter</span>(S3AQ1A ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>CHECK321 ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>SmokingFrequency ==<span class="st"> "Every Day"</span> &amp;<span class="st"> </span>Age &lt;=<span class="st"> </span><span class="dv">25</span>)
&gt;<span class="st"> </span><span class="kw">dim</span>(NESARCtbl)</code></pre></div>
<pre><code>[1] 1320   15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">str</span>(NESARCtbl)</code></pre></div>
<pre><code>Classes &lsquo;tbl_df&rsquo;, &lsquo;tbl&rsquo; and 'data.frame':   1320 obs. of  15 variables:
 $ UniqueID          : Factor w/ 43093 levels "1","2","3","4",..: 21 103 122 136 150 155 174 178 184 210 ...
 $ EthanolConsumption: num  0.0099 0.985 0.8888 0.017 0.0266 ...
 $ Ethnicity         : Factor w/ 5 levels "1","2","3","4",..: 2 1 1 1 1 2 1 5 1 2 ...
 $ SmokingFrequency  : Factor w/ 6 levels "Every Day","5 to 6 Days/week",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ Age               : num  25 24 23 21 23 21 19 19 19 24 ...
 $ MajorDepression   : Factor w/ 2 levels "0","1": 1 2 2 1 2 1 1 1 1 2 ...
 $ DysthymiaLifetime : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 2 ...
 $ TobaccoDependence : Factor w/ 2 levels "0","1": 2 2 2 1 1 2 1 1 1 1 ...
 $ DailyCigsSmoked   : num  3 10 10 20 5 8 1 10 20 3 ...
 $ S3AQ1A            : Factor w/ 3 levels "1","2","9": 1 1 1 1 1 1 1 1 1 1 ...
 $ CHECK321          : Factor w/ 3 levels "1","2","9": 1 1 1 1 1 1 1 1 1 1 ...
 $ Sex               : Factor w/ 2 levels "1","2": 2 2 2 1 2 2 1 2 2 2 ...
 $ DaysSmoke         : num  30 30 30 30 30 30 30 30 30 30 ...
 $ TotalCigsSmoked   : num  90 300 300 600 150 240 30 300 600 90 ...
 $ CigsSmokedFac     : Factor w/ 4 levels "[1,150]","(150,420]",..: 1 2 2 3 1 2 1 2 3 1 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">summary</span>(NESARCtbl)</code></pre></div>
<pre><code>    UniqueID    EthanolConsumption Ethnicity             SmokingFrequency
 21     :   1   Min.   : 0.0011    1:849     Every Day           :1320   
 103    :   1   1st Qu.: 0.0561    2:170     5 to 6 Days/week    :   0   
 122    :   1   Median : 0.3251    3: 30     3 to 4 Days/week    :   0   
 136    :   1   Mean   : 1.3485    4: 47     1 to 2 Days/week    :   0   
 150    :   1   3rd Qu.: 1.1996    5:224     2 to 3 Days/month   :   0   
 155    :   1   Max.   :32.0533              Once a month or less:   0   
 (Other):1314   NA's   :167                                              
      Age        MajorDepression DysthymiaLifetime TobaccoDependence
 Min.   :18.00   0:965           0:1234            0:521            
 1st Qu.:20.00   1:355           1:  86            1:799            
 Median :22.00                                                      
 Mean   :21.61                                                      
 3rd Qu.:24.00                                                      
 Max.   :25.00                                                      
                                                                    
 DailyCigsSmoked S3AQ1A   CHECK321 Sex       DaysSmoke  TotalCigsSmoked 
 Min.   : 1.00   1:1320   1:1320   1:646   Min.   :30   Min.   :  30.0  
 1st Qu.: 7.00   2:   0   2:   0   2:674   1st Qu.:30   1st Qu.: 210.0  
 Median :10.00   9:   0   9:   0           Median :30   Median : 300.0  
 Mean   :13.69                             Mean   :30   Mean   : 410.7  
 3rd Qu.:20.00                             3rd Qu.:30   3rd Qu.: 600.0  
 Max.   :99.00                             Max.   :30   Max.   :2970.0  
                                                                        
        CigsSmokedFac
 [1,150]       :249  
 (150,420]     :514  
 (420,600]     :465  
 (600,2.97e+03]: 92  
                     
                     
                     </code></pre>
</div>
<div id="exploratory-graphs" class="section level4">
<h4>Exploratory Graphs</h4>
<p><strong>Numeric</strong> data <span class="math inline">\(\rightarrow\)</span> histogram and density plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">library</span>(ggplot2)
&gt;<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> NESARCtbl, <span class="kw">aes</span>(<span class="dt">x =</span> EthanolConsumption) ) +<span class="st"> </span>
+<span class="st">   </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">fill =</span> <span class="st">"pink"</span>) +<span class="st"> </span>
+<span class="st">   </span><span class="kw">theme_bw</span>() +
+<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Ethanol Consumption"</span>)</code></pre></div>
<p><img src="UsingTheData_files/figure-html/EDAquan-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> NESARCtbl, <span class="kw">aes</span>(<span class="dt">x =</span> EthanolConsumption) ) +<span class="st"> </span>
+<span class="st">   </span><span class="kw">geom_density</span>(<span class="dt">fill =</span> <span class="st">"pink"</span>) +<span class="st"> </span>
+<span class="st">   </span><span class="kw">theme_bw</span>() +
+<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Ethanol Consumption"</span>)</code></pre></div>
<p><img src="UsingTheData_files/figure-html/EDAquan-2.png" width="672"></p>
<p><strong>Categorical</strong> data <span class="math inline">\(\rightarrow\)</span> bar graphs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> NESARCtbl, <span class="kw">aes</span>(<span class="dt">x =</span> Ethnicity)) +
+<span class="st">   </span><span class="kw">geom_bar</span>(<span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">"snow"</span>, <span class="st">"brown4"</span>, <span class="st">"red"</span>, <span class="st">"yellow"</span>, <span class="st">"tan"</span>), <span class="dt">color =</span> <span class="st">"black"</span>) +<span class="st"> </span>
+<span class="st">   </span><span class="kw">theme_bw</span>() </code></pre></div>
<p><img src="UsingTheData_files/figure-html/EDAqual-1.png" width="672"></p>
<p>We should provide more descriptive labels for the factors <code>Ethnicity</code>, <code>MajorDepression</code>, <code>DysthymiaLifetime</code>, and <code>TobaccoDependence</code>.</p>
</div>
<div id="changing-levels-and-labeling-variables" class="section level4">
<h4>Changing Levels and Labeling Variables</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARCtbl$TobaccoDependence &lt;-<span class="st"> </span><span class="kw">factor</span>(NESARCtbl$TobaccoDependence, 
+<span class="st">                          </span><span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"No Nicotine Dependence"</span>, <span class="st">"Nicotine Dependence"</span>))
&gt;<span class="st"> </span><span class="kw">xtabs</span>(~TobaccoDependence, <span class="dt">data =</span> NESARCtbl)</code></pre></div>
<pre><code>TobaccoDependence
No Nicotine Dependence    Nicotine Dependence 
                   521                    799 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARCtbl$TobaccoDependence &lt;-<span class="st"> </span><span class="kw">factor</span>(NESARCtbl$TobaccoDependence, 
+<span class="st">                          </span><span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">"Nicotine Dependence"</span>, <span class="st">"No Nicotine Dependence"</span>))
&gt;<span class="st"> </span><span class="kw">xtabs</span>(~TobaccoDependence, <span class="dt">data =</span> NESARCtbl)</code></pre></div>
<pre><code>TobaccoDependence
   Nicotine Dependence No Nicotine Dependence 
                   799                    521 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARCtbl$Ethnicity &lt;-<span class="st"> </span><span class="kw">factor</span>(NESARCtbl$Ethnicity, 
+<span class="st">                               </span><span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"Caucasian"</span>, <span class="st">"African American"</span>, 
+<span class="st">                                          "Native American"</span>, <span class="st">"Asian"</span>, <span class="st">"Hispanic"</span>))
&gt;<span class="st"> </span>NESARCtbl$Sex &lt;-<span class="st"> </span><span class="kw">factor</span>(NESARCtbl$Sex, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>))
&gt;<span class="st"> </span><span class="kw">table</span>(NESARCtbl$Sex)</code></pre></div>
<pre><code>
  Male Female 
   646    674 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARCtbl$Sex &lt;-<span class="st"> </span><span class="kw">factor</span>(NESARCtbl$Sex, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>))
&gt;<span class="st"> </span><span class="kw">table</span>(NESARCtbl$Sex)</code></pre></div>
<pre><code>
Female   Male 
   674    646 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>NESARCtbl$SmokingFrequency &lt;-<span class="st"> </span><span class="kw">factor</span>(NESARCtbl$SmokingFrequency, 
+<span class="st">                          </span><span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">"Once a month or less"</span>, <span class="st">"2 to 3 Days/month"</span>, <span class="st">"1 to 2 Days/week"</span>,  
+<span class="st">                                     "3 to 4 Days/week"</span>, <span class="st">"5 to 6 Days/week"</span>, <span class="st">"Every Day"</span>))
&gt;<span class="st"> </span>NESARCtbl$MajorDepression &lt;-<span class="st"> </span><span class="kw">factor</span>(NESARCtbl$MajorDepression, 
+<span class="st">                                     </span><span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"No Depression"</span>, <span class="st">"Yes Depression"</span>))
&gt;<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> NESARCtbl, <span class="kw">aes</span>(<span class="dt">x =</span> Ethnicity)) +
+<span class="st">   </span><span class="kw">geom_bar</span>(<span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">"snow"</span>, <span class="st">"brown4"</span>, <span class="st">"red"</span>, <span class="st">"yellow"</span>, <span class="st">"tan"</span>), <span class="dt">color =</span> <span class="st">"black"</span>) +<span class="st"> </span>
+<span class="st">   </span><span class="kw">theme_bw</span>() +<span class="st"> </span>
+<span class="st">   </span><span class="kw">theme</span>(<span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">55</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) +<span class="st"> </span>
+<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">""</span>)</code></pre></div>
<p><img src="UsingTheData_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>T1 &lt;-<span class="st"> </span><span class="kw">xtabs</span>(~<span class="st"> </span>TobaccoDependence +<span class="st"> </span>MajorDepression, <span class="dt">data =</span> NESARCtbl)
&gt;<span class="st"> </span>T1</code></pre></div>
<pre><code>                        MajorDepression
TobaccoDependence        No Depression Yes Depression
  Nicotine Dependence              510            289
  No Nicotine Dependence           455             66</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> NESARCtbl, <span class="kw">aes</span>(<span class="dt">x =</span> MajorDepression, <span class="dt">fill =</span> TobaccoDependence)) +
+<span class="st">   </span><span class="kw">geom_bar</span>() +<span class="st"> </span>
+<span class="st">   </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="UsingTheData_files/figure-html/ggSmoke2A-1.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>T2 &lt;-<span class="st"> </span><span class="kw">prop.table</span>(T1, <span class="dv">2</span>)
&gt;<span class="st"> </span>T2</code></pre></div>
<pre><code>                        MajorDepression
TobaccoDependence        No Depression Yes Depression
  Nicotine Dependence        0.5284974      0.8140845
  No Nicotine Dependence     0.4715026      0.1859155</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> NESARCtbl, <span class="kw">aes</span>(<span class="dt">x =</span> MajorDepression, <span class="dt">fill =</span> TobaccoDependence)) +
+<span class="st">   </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">"fill"</span>) +<span class="st"> </span>
+<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">""</span>, <span class="dt">y =</span> <span class="st">"Fraction"</span>, 
+<span class="st">        </span><span class="dt">title =</span> <span class="st">"Fraction of young adult daily smokers</span><span class="ch">\n</span><span class="st">with and without nicotine addiction</span><span class="ch">\n</span><span class="st">by depression status"</span>) +
+<span class="st">   </span><span class="kw">theme_bw</span>() +
+<span class="st">   </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">"red"</span>, <span class="st">"pink"</span>), <span class="dt">name =</span> <span class="st">"Tobacco Addiction Status"</span>)</code></pre></div>
<p><img src="UsingTheData_files/figure-html/ggSmoke2A-2.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>###
<span class="er">&gt;</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> NESARCtbl, <span class="kw">aes</span>(<span class="dt">x =</span> MajorDepression, <span class="dt">fill =</span> TobaccoDependence)) +
+<span class="st">   </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">"fill"</span>) +<span class="st"> </span>
+<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">""</span>, <span class="dt">y =</span> <span class="st">"Fraction"</span>, 
+<span class="st">        </span><span class="dt">title =</span> <span class="st">"Fraction of young adult daily smokers</span><span class="ch">\n</span><span class="st">with and without nicotine addiction</span><span class="ch">\n</span><span class="st">by depression status"</span>) +
+<span class="st">   </span><span class="kw">theme_bw</span>() +
+<span class="st">   </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">"red"</span>, <span class="st">"pink"</span>), <span class="dt">name =</span> <span class="st">"Tobacco Addiction Status"</span>) +<span class="st"> </span>
+<span class="st">   </span><span class="kw">facet_grid</span>(Sex ~<span class="st"> </span>.)</code></pre></div>
<p><img src="UsingTheData_files/figure-html/ggSmoke2A-3.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> NESARCtbl, <span class="kw">aes</span>(<span class="dt">x =</span> MajorDepression, <span class="dt">fill =</span> TobaccoDependence)) +
+<span class="st">   </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">"fill"</span>) +<span class="st"> </span>
+<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">""</span>, <span class="dt">y =</span> <span class="st">"Fraction"</span>, 
+<span class="st">        </span><span class="dt">title =</span> <span class="st">"Fraction of young adult daily smokers</span><span class="ch">\n</span><span class="st">with and without nicotine addiction</span><span class="ch">\n</span><span class="st">by depression status"</span>) +
+<span class="st">   </span><span class="kw">theme_bw</span>() +
+<span class="st">   </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">"red"</span>, <span class="st">"pink"</span>), <span class="dt">name =</span> <span class="st">"Tobacco Addiction Status"</span>) +<span class="st"> </span>
+<span class="st">   </span><span class="kw">facet_grid</span>(Ethnicity ~<span class="st"> </span>Sex) +
+<span class="st">   </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="UsingTheData_files/figure-html/unnamed-chunk-12-1.png" width="624"></p>
</div>
</div>
<div id="merging-data-sets" class="section level3">
<h3>Merging Data Sets</h3>
<p>To merge <code>AddHealth</code> Wave I with <code>addhealth_public4</code> Wave IV one can use the <code>left_join()</code> function from <code>dplyr</code>. The <code>left_join</code> function returns all rows from the first argument (data frame), and all columns from both the first and second arguments (both data frames). To use <code>left_join</code>, one needs a common variable in both data frames. Note: Although the code book for Wave IV uses upper case for variable names, the variable names in the data frame <code>addhealth_public4</code> are all lower case.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">library</span>(dplyr)
&gt;<span class="st"> </span>AddHealthW4 &lt;-<span class="st"> </span><span class="kw">tbl_df</span>(addhealth_public4) %&gt;%<span class="st"> </span>
+<span class="st">   </span><span class="kw">rename</span>(<span class="dt">AID =</span> aid)
&gt;<span class="st"> </span>AddHealthW1and4 &lt;-<span class="st"> </span><span class="kw">left_join</span>(AddHealthW4, AddHealth)
&gt;<span class="st"> </span><span class="kw">dim</span>(AddHealthW1and4)</code></pre></div>
<pre><code>[1] 6504 3804</code></pre>
<div id="kable" class="section level4">
<h4>kable</h4>
<table><caption>Three Selected Columns</caption>
<thead><tr class="header"><th align="center">EthanolConsumption</th>
<th align="center">Sex</th>
<th align="center">MajorDepression</th>
</tr></thead><tbody><tr class="odd"><td align="center">1.9585</td>
<td align="center">Male</td>
<td align="center">No Depression</td>
</tr><tr class="even"><td align="center">0.7749</td>
<td align="center">Female</td>
<td align="center">Yes Depression</td>
</tr><tr class="odd"><td align="center">0.0444</td>
<td align="center">Male</td>
<td align="center">Yes Depression</td>
</tr><tr class="even"><td align="center">0.0217</td>
<td align="center">Female</td>
<td align="center">Yes Depression</td>
</tr><tr class="odd"><td align="center">1.1189</td>
<td align="center">Male</td>
<td align="center">No Depression</td>
</tr><tr class="even"><td align="center">4.4192</td>
<td align="center">Male</td>
<td align="center">Yes Depression</td>
</tr></tbody></table><table><caption>Three Selected Columns</caption>
<thead><tr class="header"><th align="center">Ethanol Consuption</th>
<th align="center">Gender</th>
<th align="center">Depression</th>
</tr></thead><tbody><tr class="odd"><td align="center">1.9585</td>
<td align="center">Male</td>
<td align="center">No Depression</td>
</tr><tr class="even"><td align="center">0.7749</td>
<td align="center">Female</td>
<td align="center">Yes Depression</td>
</tr><tr class="odd"><td align="center">0.0444</td>
<td align="center">Male</td>
<td align="center">Yes Depression</td>
</tr><tr class="even"><td align="center">0.0217</td>
<td align="center">Female</td>
<td align="center">Yes Depression</td>
</tr><tr class="odd"><td align="center">1.1189</td>
<td align="center">Male</td>
<td align="center">No Depression</td>
</tr><tr class="even"><td align="center">4.4192</td>
<td align="center">Male</td>
<td align="center">Yes Depression</td>
</tr></tbody></table></div>
<div id="pander" class="section level4">
<h4>pander</h4>
<table style="width:62%;"><caption>Three Selected Columns</caption>
<colgroup><col width="29%"><col width="9%"><col width="23%"></colgroup><thead><tr class="header"><th align="center">EthanolConsumption</th>
<th align="center">Sex</th>
<th align="center">MajorDepression</th>
</tr></thead><tbody><tr class="odd"><td align="center">1.9585</td>
<td align="center">Male</td>
<td align="center">No Depression</td>
</tr><tr class="even"><td align="center">0.7749</td>
<td align="center">Female</td>
<td align="center">Yes Depression</td>
</tr><tr class="odd"><td align="center">0.0444</td>
<td align="center">Male</td>
<td align="center">Yes Depression</td>
</tr><tr class="even"><td align="center">0.0217</td>
<td align="center">Female</td>
<td align="center">Yes Depression</td>
</tr><tr class="odd"><td align="center">1.1189</td>
<td align="center">Male</td>
<td align="center">No Depression</td>
</tr><tr class="even"><td align="center">4.4192</td>
<td align="center">Male</td>
<td align="center">Yes Depression</td>
</tr></tbody></table></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked"><li><a href="#using-pds">Using <strong>PDS</strong></a></li>
      </ul></div>
      </div>

</div>


      <footer><p>Built by <a href="http://hadley.github.io/pkgdown/">pkgdown</a>. Styled with <a href="http://getbootstrap.com">Bootstrap 3</a>.</p>
      </footer></div>

  </body></html>
